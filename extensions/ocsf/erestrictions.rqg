PREFIX ocsf: <https://schema.ocsf.io/1.3.0/ontology/>
PREFIX d3f: <http://d3fend.mitre.org/ontologies/d3fend.owl#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX dcterms: <http://purl.org/dc/terms/>
PREFIX iter: <http://w3id.org/sparql-generate/iter/>
PREFIX fun: <http://w3id.org/sparql-generate/fn/>

GENERATE <https://schema.ocsf.io/1.3.0/erestrictions> () {
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?baseEvent ) .

  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?api ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?application ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?applicationLifecycle ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?datastoreActivity ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?fileHosting ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?scanActivity ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?webResourceAccessActivity ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?webResourcesActivity ) .

  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?configState ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?deviceConfigStateChange ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?discovery ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?discoveryResult ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?fileQuery ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?folderQuery ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?groupQuery ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?inventoryInfo ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?jobQuery ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?kernelObjectQuery ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?moduleQuery ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?networkConnectionQuery ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?networksQuery ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?patchState ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?peripheralDeviceQuery ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?processQuery ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?serviceQuery ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?sessionQuery ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?softwareInventoryInfo ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?userInventory ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?userQuery ) .

  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?complianceFinding ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?dataSecurityFinding ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?detectionFinding ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?finding ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?incidentFinding ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?securityFinding ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?vulnerabilityFinding ) .

  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?accountChange ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?authentication ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?authorizeSession ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?entityManagement ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?groupManagement ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?iam ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?userAccess ) .

  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?dhcp ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?dns ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?email ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?emailFile ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?emailUrl ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?fileActivity ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?ftp ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?http ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?network ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?networkActivity ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?ntp ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?rdp ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?smb ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?ssh ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?tunnelActivity ) .

  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?eventLog ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?filesystem ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?kernel ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?kernelExtension ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?memory ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?module ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?process ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?scheduledJob ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?system ) .

  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?fileRemediationActivity ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?networkRemediationActivity ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?processRemediationActivity ) .
  GENERATE <https://schema.ocsf.io/1.3.0/erestriction> ( ?remediationActivity ) .

}

WHERE {
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/base_event.json") AS ?baseEvent )

  # Application Activity
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/application/api.json") AS ?api )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/application/application.json") AS ?application )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/application/application_lifecycle.json") AS ?applicationLifecycle )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/application/datastore_activity.json") AS ?datastoreActivity )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/application/file_hosting.json") AS ?fileHosting )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/application/scan_activity.json") AS ?scanActivity )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/application/web_resource_access_activity.json") AS ?webResourceAccessActivity )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/application/web_resources_activity.json") AS ?webResourcesActivity )

  # Discovery
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/config_state.json") AS ?configState )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/device_config_state_change.json") AS ?deviceConfigStateChange )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/discovery.json") AS ?discovery )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/discovery_result.json") AS ?discoveryResult )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/file_query.json") AS ?fileQuery )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/folder_query.json") AS ?folderQuery )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/group_query.json") AS ?groupQuery )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/inventory_info.json") AS ?inventoryInfo )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/job_query.json") AS ?jobQuery )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/kernel_object_query.json") AS ?kernelObjectQuery )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/module_query.json") AS ?moduleQuery )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/network_connection_query.json") AS ?networkConnectionQuery )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/networks_query.json") AS ?networksQuery )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/patch_state.json") AS ?patchState )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/peripheral_device_query.json") AS ?peripheralDeviceQuery )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/process_query.json") AS ?processQuery )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/service_query.json") AS ?serviceQuery )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/session_query.json") AS ?sessionQuery )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/software_inventory_info.json") AS ?softwareInventoryInfo )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/user_inventory.json") AS ?userInventory )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/discovery/user_query.json") AS ?userQuery )

  # Findings
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/findings/compliance_finding.json") AS ?complianceFinding )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/findings/data_security_finding.json") AS ?dataSecurityFinding )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/findings/detection_finding.json") AS ?detectionFinding )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/findings/finding.json") AS ?finding )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/findings/incident_finding.json") AS ?incidentFinding )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/findings/security_finding.json") AS ?securityFinding )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/findings/vulnerability_finding.json") AS ?vulnerabilityFinding )

  # IAM
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/iam/account_change.json") AS ?accountChange )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/iam/authentication.json") AS ?authentication )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/iam/authorize_session.json") AS ?authorizeSession )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/iam/entity_management.json") AS ?entityManagement )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/iam/group_management.json") AS ?groupManagement )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/iam/iam.json") AS ?iam )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/iam/user_access.json") AS ?userAccess )

  # Network Activity
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/dhcp.json") AS ?dhcp )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/dns.json") AS ?dns )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/email.json") AS ?email )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/email_file.json") AS ?emailFile )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/email_url.json") AS ?emailUrl )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/file_activity.json") AS ?fileActivity )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/ftp.json") AS ?ftp )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/http.json") AS ?http )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/network.json") AS ?network )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/network_activity.json") AS ?networkActivity )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/ntp.json") AS ?ntp )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/rdp.json") AS ?rdp )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/smb.json") AS ?smb )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/ssh.json") AS ?ssh )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/network/tunnel_activity.json") AS ?tunnelActivity )

  # System Activity
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/system/event_log.json") AS ?eventLog )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/system/filesystem.json") AS ?filesystem )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/system/kernel.json") AS ?kernel )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/system/kernel_extension.json") AS ?kernelExtension )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/system/memory.json") AS ?memory )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/system/module.json") AS ?module )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/system/process.json") AS ?process )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/system/scheduled_job.json") AS ?scheduledJob )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/system/system.json") AS ?system )

  # Remediation
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/remediation/file_remediation_activity.json") AS ?fileRemediationActivity )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/remediation/network_remediation_activity.json") AS ?networkRemediationActivity )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/remediation/process_remediation_activity.json") AS ?processRemediationActivity )
  BIND ( IRI("https://raw.githubusercontent.com/ocsf/ocsf-schema/1.3.0/events/remediation/remediation_activity.json") AS ?remediationActivity )

}
